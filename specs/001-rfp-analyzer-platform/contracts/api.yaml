openapi: 3.0.3
info:
  title: RFP Analyzer Platform API
  description: |
    REST API for the RFP Analyzer Platform. Provides endpoints for fetching RFP data,
    requirements hierarchy, supplier responses, and updating evaluation data.

    All endpoints are implemented as Next.js API routes.
  version: 1.0.0
  contact:
    name: RFP Analyzer Team

servers:
  - url: http://localhost:3000/api
    description: Local development
  - url: https://rfp-analyzer.vercel.app/api
    description: Production

tags:
  - name: Auth
    description: Authentication and session management endpoints
  - name: Organizations
    description: Organization management endpoints
  - name: Users
    description: User management and invitation endpoints
  - name: RFPs
    description: RFP management endpoints
  - name: Requirements
    description: Requirements hierarchy endpoints
  - name: Suppliers
    description: Supplier information endpoints
  - name: Responses
    description: Supplier response evaluation endpoints

paths:
  # ============================================
  # Authentication Endpoints
  # ============================================
  /auth/register:
    post:
      tags: [Auth]
      summary: Register new user and create organization
      description: |
        Creates a new user account and optionally their first organization.
        First user in an organization becomes admin by default.
      operationId: register
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
                - fullName
                - organizationName
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  minLength: 8
                fullName:
                  type: string
                organizationName:
                  type: string
                  description: Name of the organization to create
                organizationSlug:
                  type: string
                  pattern: "^[a-z0-9-]+$"
                  description: URL-friendly slug (auto-generated if not provided)
      responses:
        "201":
          description: User and organization created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: "#/components/schemas/User"
                  organization:
                    $ref: "#/components/schemas/Organization"
                  session:
                    type: object
                    description: Auth session details
        "400":
          description: Invalid input or email already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/login:
    post:
      tags: [Auth]
      summary: Login with email and password
      description: Authenticates user and returns session token
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: "#/components/schemas/User"
                  organizations:
                    type: array
                    items:
                      $ref: "#/components/schemas/Organization"
                  session:
                    type: object
                    description: Auth session details
        "401":
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /auth/logout:
    post:
      tags: [Auth]
      summary: Logout current user
      description: Invalidates the current session
      operationId: logout
      responses:
        "200":
          description: Logout successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string

  /auth/me:
    get:
      tags: [Auth]
      summary: Get current user profile
      description: Returns authenticated user's profile and organizations
      operationId: getMe
      security:
        - BearerAuth: []
      responses:
        "200":
          description: User profile retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: "#/components/schemas/User"
                  organizations:
                    type: array
                    items:
                      $ref: "#/components/schemas/OrganizationWithRole"
        "401":
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # ============================================
  # Organization Endpoints
  # ============================================
  /organizations:
    get:
      tags: [Organizations]
      summary: Get user's organizations
      description: Returns all organizations the authenticated user belongs to
      operationId: getOrganizations
      security:
        - BearerAuth: []
      responses:
        "200":
          description: Organizations retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  organizations:
                    type: array
                    items:
                      $ref: "#/components/schemas/OrganizationWithRole"
        "401":
          description: Not authenticated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    post:
      tags: [Organizations]
      summary: Create new organization
      description: Creates a new organization with the current user as admin
      operationId: createOrganization
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                slug:
                  type: string
                  pattern: "^[a-z0-9-]+$"
      responses:
        "201":
          description: Organization created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Organization"
        "400":
          description: Invalid input or slug already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /organizations/{organizationId}:
    get:
      tags: [Organizations]
      summary: Get organization details
      description: Returns detailed information about a specific organization
      operationId: getOrganization
      security:
        - BearerAuth: []
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Organization retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Organization"
        "403":
          description: User not member of this organization
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put:
      tags: [Organizations]
      summary: Update organization
      description: Updates organization details (admin only)
      operationId: updateOrganization
      security:
        - BearerAuth: []
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                settings:
                  type: object
      responses:
        "200":
          description: Organization updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Organization"
        "403":
          description: User is not organization admin
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /organizations/{organizationId}/members:
    get:
      tags: [Users]
      summary: Get organization members
      description: Returns all users in the organization with their roles
      operationId: getOrganizationMembers
      security:
        - BearerAuth: []
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Members retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  members:
                    type: array
                    items:
                      $ref: "#/components/schemas/UserWithRole"
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                      limit:
                        type: integer
                        description: Max users allowed for this org's subscription tier

  /organizations/{organizationId}/invite:
    post:
      tags: [Users]
      summary: Invite user to organization
      description: Sends an email invitation to join the organization (admin only)
      operationId: inviteUser
      security:
        - BearerAuth: []
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - role
              properties:
                email:
                  type: string
                  format: email
                role:
                  type: string
                  enum: [admin, evaluator, viewer]
      responses:
        "201":
          description: Invitation sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  invitationId:
                    type: string
                    format: uuid
        "403":
          description: User is not organization admin or user limit reached
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /organizations/{organizationId}/members/{userId}:
    delete:
      tags: [Users]
      summary: Remove user from organization
      description: Removes a user from the organization (admin only)
      operationId: removeOrganizationMember
      security:
        - BearerAuth: []
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: User removed successfully
        "403":
          description: User is not organization admin
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    patch:
      tags: [Users]
      summary: Update user role in organization
      description: Changes a user's role in the organization (admin only)
      operationId: updateMemberRole
      security:
        - BearerAuth: []
      parameters:
        - name: organizationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - role
              properties:
                role:
                  type: string
                  enum: [admin, evaluator, viewer]
      responses:
        "200":
          description: Role updated successfully
        "403":
          description: User is not organization admin
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # ============================================
  # RFP User Assignment Endpoints
  # ============================================
  /rfps/{rfpId}/assignments:
    get:
      tags: [RFPs]
      summary: Get RFP user assignments
      description: Returns all users assigned to this RFP with their access levels
      operationId: getRFPAssignments
      security:
        - BearerAuth: []
      parameters:
        - name: rfpId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Assignments retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  assignments:
                    type: array
                    items:
                      $ref: "#/components/schemas/RFPUserAssignment"

    post:
      tags: [RFPs]
      summary: Assign user to RFP
      description: Assigns a user to this RFP with specific access level (owner/evaluator only)
      operationId: assignUserToRFP
      security:
        - BearerAuth: []
      parameters:
        - name: rfpId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - accessLevel
              properties:
                userId:
                  type: string
                  format: uuid
                accessLevel:
                  type: string
                  enum: [owner, evaluator, viewer]
      responses:
        "201":
          description: User assigned successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RFPUserAssignment"
        "403":
          description: User does not have permission to manage assignments
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /rfps/{rfpId}/assignments/{userId}:
    delete:
      tags: [RFPs]
      summary: Remove user assignment from RFP
      description: Removes a user's access to this RFP (owner only)
      operationId: removeRFPAssignment
      security:
        - BearerAuth: []
      parameters:
        - name: rfpId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: userId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Assignment removed successfully
        "403":
          description: User is not RFP owner
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # ============================================
  # RFP Endpoints (with multi-tenant context)
  # ============================================
  /rfps:
    get:
      tags: [RFPs]
      summary: Get all RFPs for current organization
      description: Returns RFPs accessible by the authenticated user in their current organization context
      operationId: getRFPs
      security:
        - BearerAuth: []
      parameters:
        - name: organizationId
          in: query
          required: true
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum: [active, in_progress, completed, archived]
      responses:
        "200":
          description: RFPs retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  rfps:
                    type: array
                    items:
                      $ref: "#/components/schemas/RFP"
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                      limit:
                        type: integer
                        description: Max RFPs allowed for this org's subscription tier

    post:
      tags: [RFPs]
      summary: Create new RFP
      description: Creates a new RFP in the current organization (admin/evaluator only)
      operationId: createRFP
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - organizationId
                - title
              properties:
                organizationId:
                  type: string
                  format: uuid
                title:
                  type: string
                description:
                  type: string
      responses:
        "201":
          description: RFP created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RFP"
        "403":
          description: User does not have permission or RFP limit reached
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /rfps/{rfpId}:
    get:
      tags: [RFPs]
      summary: Get RFP details
      description: Fetches basic information about a specific RFP
      operationId: getRFP
      parameters:
        - name: rfpId
          in: path
          required: true
          description: UUID of the RFP
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RFP"
        "404":
          description: RFP not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /rfps/{rfpId}/requirements:
    get:
      tags: [Requirements]
      summary: Get all requirements for an RFP
      description: |
        Fetches the complete hierarchical tree of requirements (4 levels) for an RFP.
        Returns requirements ordered by hierarchy level and position.
      operationId: getRequirements
      parameters:
        - name: rfpId
          in: path
          required: true
          description: UUID of the RFP
          schema:
            type: string
            format: uuid
        - name: level
          in: query
          required: false
          description: Filter by hierarchy level (1-4)
          schema:
            type: integer
            minimum: 1
            maximum: 4
        - name: flat
          in: query
          required: false
          description: Return flat list instead of nested tree
          schema:
            type: boolean
            default: false
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  requirements:
                    type: array
                    items:
                      $ref: "#/components/schemas/Requirement"
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                      levels:
                        type: object
                        additionalProperties:
                          type: integer
        "404":
          description: RFP not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /rfps/{rfpId}/suppliers:
    get:
      tags: [Suppliers]
      summary: Get all suppliers for an RFP
      description: Fetches the list of suppliers participating in this RFP
      operationId: getSuppliers
      parameters:
        - name: rfpId
          in: path
          required: true
          description: UUID of the RFP
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  suppliers:
                    type: array
                    items:
                      $ref: "#/components/schemas/Supplier"
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
        "404":
          description: RFP not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /rfps/{rfpId}/responses:
    get:
      tags: [Responses]
      summary: Get all responses for an RFP
      description: |
        Fetches all supplier responses for the entire RFP. Can be filtered by
        requirement or supplier. Use for bulk operations or summary views.
      operationId: getResponses
      parameters:
        - name: rfpId
          in: path
          required: true
          description: UUID of the RFP
          schema:
            type: string
            format: uuid
        - name: requirementId
          in: query
          required: false
          description: Filter by specific requirement
          schema:
            type: string
            format: uuid
        - name: supplierId
          in: query
          required: false
          description: Filter by specific supplier
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          required: false
          description: Filter by evaluation status
          schema:
            type: string
            enum: [pending, pass, partial, fail]
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  responses:
                    type: array
                    items:
                      $ref: "#/components/schemas/Response"
                  meta:
                    type: object
                    properties:
                      total:
                        type: integer
                      byStatus:
                        type: object
                        additionalProperties:
                          type: integer
        "404":
          description: RFP not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /requirements/{requirementId}:
    get:
      tags: [Requirements]
      summary: Get a specific requirement
      description: |
        Fetches detailed information about a single requirement, including its
        breadcrumb path and completion status.
      operationId: getRequirement
      parameters:
        - name: requirementId
          in: path
          required: true
          description: UUID of the requirement
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  requirement:
                    $ref: "#/components/schemas/Requirement"
                  breadcrumb:
                    type: array
                    description: Hierarchical path from root to this requirement
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                        externalId:
                          type: string
                        title:
                          type: string
                        level:
                          type: integer
                  completionStatus:
                    type: object
                    properties:
                      totalResponses:
                        type: integer
                      checkedResponses:
                        type: integer
                      isComplete:
                        type: boolean
        "404":
          description: Requirement not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /responses/{responseId}:
    get:
      tags: [Responses]
      summary: Get a specific response
      description: Fetches detailed information about a single supplier response
      operationId: getResponse
      parameters:
        - name: responseId
          in: path
          required: true
          description: UUID of the response
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Response"
        "404":
          description: Response not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    put:
      tags: [Responses]
      summary: Update response evaluation
      description: |
        Updates evaluator-provided fields for a response: manual score, status,
        comments, questions, and checkbox state. Used for all evaluation actions.
      operationId: updateResponse
      parameters:
        - name: responseId
          in: path
          required: true
          description: UUID of the response
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResponseUpdate"
      responses:
        "200":
          description: Response updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Response"
        "400":
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Response not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Supabase Auth JWT token

  schemas:
    # ============================================
    # Authentication & User Schemas
    # ============================================
    User:
      type: object
      required:
        - id
        - email
        - fullName
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: User ID (references Supabase auth.users)
        email:
          type: string
          format: email
        fullName:
          type: string
        avatarUrl:
          type: string
          format: uri
          nullable: true
        preferences:
          type: object
          nullable: true
          description: User preferences (theme, notifications, etc.)
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    Organization:
      type: object
      required:
        - id
        - name
        - slug
        - subscriptionTier
        - createdAt
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: "TechCorp Inc."
        slug:
          type: string
          pattern: "^[a-z0-9-]+$"
          example: "techcorp-inc"
        settings:
          type: object
          nullable: true
          description: Organization-specific settings
        subscriptionTier:
          type: string
          enum: [free, pro, enterprise]
          default: free
        maxUsers:
          type: integer
          description: Maximum users allowed
          example: 10
        maxRfps:
          type: integer
          description: Maximum active RFPs allowed
          example: 5
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    OrganizationWithRole:
      allOf:
        - $ref: "#/components/schemas/Organization"
        - type: object
          required:
            - role
          properties:
            role:
              type: string
              enum: [admin, evaluator, viewer]
              description: User's role in this organization

    UserWithRole:
      allOf:
        - $ref: "#/components/schemas/User"
        - type: object
          required:
            - role
            - joinedAt
          properties:
            role:
              type: string
              enum: [admin, evaluator, viewer]
            joinedAt:
              type: string
              format: date-time
              description: When user joined this organization

    RFPUserAssignment:
      type: object
      required:
        - id
        - rfpId
        - userId
        - accessLevel
        - assignedAt
      properties:
        id:
          type: string
          format: uuid
        rfpId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        user:
          $ref: "#/components/schemas/User"
          description: Populated user object (when joined)
        accessLevel:
          type: string
          enum: [owner, evaluator, viewer]
          description: User's access level for this specific RFP
        assignedBy:
          type: string
          format: uuid
          nullable: true
          description: User ID who created this assignment
        assignedAt:
          type: string
          format: date-time

    # ============================================
    # RFP & Requirements Schemas
    # ============================================
    RFP:
      type: object
      required:
        - id
        - title
        - status
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique RFP identifier
        title:
          type: string
          description: RFP name
          example: "Infrastructure Cloud 2025"
        description:
          type: string
          nullable: true
          description: Detailed RFP description
        status:
          type: string
          enum: [in_progress, completed, archived]
          description: Current RFP status
        organizationId:
          type: string
          format: uuid
          description: Organization ID (required for multi-tenant isolation)
        createdBy:
          type: string
          format: uuid
          description: User ID who created the RFP
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp

    Requirement:
      type: object
      required:
        - id
        - rfpId
        - externalId
        - title
        - level
        - weight
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique requirement identifier
        rfpId:
          type: string
          format: uuid
          description: Parent RFP ID
        externalId:
          type: string
          description: External identifier from N8N
          example: "REQ-001"
        title:
          type: string
          description: Requirement name
          example: "Chiffrement des données en transit (TLS 1.3)"
        description:
          type: string
          nullable: true
          description: Multi-line description with bullet points
        context:
          type: string
          nullable: true
          description: Background information (3-4 paragraphs) from RFP document
        parentId:
          type: string
          format: uuid
          nullable: true
          description: Parent requirement ID (null for level 1)
        level:
          type: integer
          minimum: 1
          maximum: 4
          description: Hierarchy level (1=Domain, 2=Category, 3=Subcategory, 4=Requirement)
        weight:
          type: number
          format: float
          minimum: 0
          maximum: 1
          description: Importance weight (0.0 to 1.0)
        positionInPdf:
          type: object
          nullable: true
          description: PDF location metadata
          properties:
            page:
              type: integer
            coordinates:
              type: object
        pdfUrl:
          type: string
          format: uri
          nullable: true
          description: Link to PDF document for context
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
        children:
          type: array
          description: Child requirements (for nested tree structure)
          items:
            $ref: "#/components/schemas/Requirement"

    Supplier:
      type: object
      required:
        - id
        - rfpId
        - externalId
        - name
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique supplier identifier
        rfpId:
          type: string
          format: uuid
          description: Parent RFP ID
        externalId:
          type: string
          description: External identifier from N8N
          example: "SUP-A"
        name:
          type: string
          description: Supplier company name
          example: "TechCorp Solutions"
        contactName:
          type: string
          nullable: true
          description: Contact person name
        contactEmail:
          type: string
          format: email
          nullable: true
          description: Contact email address
        contactPhone:
          type: string
          nullable: true
          description: Contact phone number
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp

    Response:
      type: object
      required:
        - id
        - rfpId
        - requirementId
        - supplierId
        - status
        - isChecked
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
          description: Unique response identifier
        rfpId:
          type: string
          format: uuid
          description: Parent RFP ID
        requirementId:
          type: string
          format: uuid
          description: Requirement being answered
        supplierId:
          type: string
          format: uuid
          description: Supplier providing response
        responseText:
          type: string
          nullable: true
          description: Full response text from supplier
        aiScore:
          type: integer
          minimum: 0
          maximum: 5
          nullable: true
          description: AI-generated score (0-5 stars)
        aiComment:
          type: string
          nullable: true
          description: AI-generated analysis commentary
        manualScore:
          type: integer
          minimum: 0
          maximum: 5
          nullable: true
          description: Evaluator's manual score (0-5 stars, null if not set)
        status:
          type: string
          enum: [pending, pass, partial, fail]
          description: Evaluation status
        isChecked:
          type: boolean
          description: Completion checkbox state
        manualComment:
          type: string
          nullable: true
          description: Evaluator's comments
        question:
          type: string
          nullable: true
          description: Evaluator's questions/doubts
        finalScore:
          type: integer
          minimum: 0
          maximum: 5
          nullable: true
          description: Computed field - manual score if set, otherwise AI score
          readOnly: true
        lastModifiedBy:
          type: string
          format: uuid
          nullable: true
          description: User ID who last modified this response
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
        supplier:
          $ref: "#/components/schemas/Supplier"
          description: Populated supplier object (when joined)

    ResponseUpdate:
      type: object
      description: Fields that can be updated by evaluators
      properties:
        manualScore:
          type: integer
          minimum: 0
          maximum: 5
          nullable: true
          description: Manual score (0-5), null to clear
        status:
          type: string
          enum: [pending, pass, partial, fail]
          description: Evaluation status
        isChecked:
          type: boolean
          description: Completion checkbox state
        manualComment:
          type: string
          nullable: true
          description: Evaluator's comments
        question:
          type: string
          nullable: true
          description: Evaluator's questions/doubts
      example:
        manualScore: 5
        status: "pass"
        isChecked: true
        manualComment: "Excellente réponse, certification à jour"
        question: null

    Error:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
          description: Error type
          example: "NOT_FOUND"
        message:
          type: string
          description: Human-readable error message
          example: "RFP not found with id: 123e4567-e89b-12d3-a456-426614174000"
        details:
          type: object
          nullable: true
          description: Additional error details (validation errors, etc.)
